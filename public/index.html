<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8"/>
        <title>With &lt;3 from 2J</title>
        <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
        <script src="/socket.io/socket.io.js"></script>
        <script src="aframe-stereo-component.min.js"></script>
        <style>
            body {margin: 0;}
            #status {position: absolute; top: 10px; left: 10px; background: #0008; color: #fff; padding: 5px 10px; font-size: 14px;}
    </style>
    </head>
    <body>
        <div id="status">ðŸ“¡ æŽ¥ç¶šä¸­...</div>
        <a-scene>
            <a-assets>
                <img id="space" src="sky.jpg"/>
                <img id="earth" src="ocean.jpg"/>
            </a-assets>

            <a-entity camera look-controls position="0 0 0" stereocam="eye:left;">
                <a-cursor color="red"></a-cursor>
            </a-entity>

            <a-box id="movingBox" position="0 1 -3" rotation="0 45 0" color="#4CC3D9" depth="1" height="1" width="1"></a-box>

            <a-entity id="sphere"
          geometry="primitive: sphere; radius: 5000;"
          material="shader: flat; src: #space; side: back;"
          scale="-1 1 1"
          stereo="eye:left">
            </a-entity>

        </a-scene>
        <script>
            const uuid = localStorage.getItem('uuid') || crypto.randomUUID();
            const socket = io({ query: { uuid } });
            localStorage.setItem('uuid', uuid);
            const sphere = document.querySelector('#sphere');
            const status = document.querySelector('#status');
            const box = document.querySelector('#movingBox');
              
            socket.on('connect', () => {
                status.textContent = 'âœ… æŽ¥ç¶šæˆåŠŸï¼';
            });
      
            socket.on('disconnect', () => {
                status.textContent = 'âŒ æŽ¥ç¶šãŒåˆ‡ã‚Œã¾ã—ãŸ';
            });
      
            socket.on('sceneUpdate', (sceneName) => {
                console.log('ðŸ” ã‚·ãƒ¼ãƒ³æ›´æ–°:', sceneName);
                let textureId = sceneName === 'space' ? '#space' : '#earth';
                sphere.setAttribute('material', 'src', textureId);
            });
            let direction = 1;
            const pos = box.getAttribute('position');
            setInterval(() => {
                if (pos.x > 2 || pos.x < -2) direction *= -1;
                pos.x += 0.05 * direction;
            }, 50);
            box.setAttribute('position', pos);
        </script>
    </body>
</html>